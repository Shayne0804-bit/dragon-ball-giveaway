const translations = {
  fr: {
    // Header & Navigation
    title: 'Dragon Ball Giveaway',
    selectGiveaway: 'SÃ©lectionner un Giveaway',
    giveawayInfo: 'Infos du Giveaway',
    uploadPhotos: 'TÃ©lÃ©charger des Photos',
    language: 'Langue',
    french: 'FranÃ§ais',
    english: 'English',

    // Giveaway Selection
    noGiveaways: 'Aucun giveaway actif',
    createNew: 'CrÃ©er un nouveau giveaway',
    giveawayName: 'Nom du giveaway',
    giveawayDescription: 'Description',
    duration: 'DurÃ©e',
    days: 'jours',
    hours: 'heures',
    startGiveaway: 'Lancer le giveaway',
    resetGiveaway: 'Nouvelle Roulette',
    participants: 'Participants',
    winners: 'Gagnants',
    endDate: 'Fin prÃ©vue',

    // Photos
    uploadPhotosTitle: 'Ajouter des Photos',
    dragAndDrop: 'Glissez les photos ou cliquez',
    maxPhotos: 'Max 10 photos',
    deletePhoto: 'Supprimer',
    noPhotos: 'Aucune photo tÃ©lÃ©chargÃ©e',

    // Participation
    participateButton: 'Participer',
    discordLoginRequired: 'Connexion Discord requise',
    loginWithDiscord: 'Se connecter avec Discord',
    participationSuccess: 'Participation enregistrÃ©e!',
    participationError: 'Erreur lors de la participation',
    alreadyParticipated: 'Vous avez dÃ©jÃ  participÃ© Ã  ce giveaway',
    nextAllowed: 'Vous pourrez reparticiper dans',
    minutes: 'minutes',
    hours: 'heures',

    // Roulette/Wheel
    spinWheel: 'Tourner la Roue',
    selectWinner: 'SÃ©lectionner un Gagnant',
    winner: 'GAGNANT!',
    winnerAnnounced: 'Le gagnant a Ã©tÃ© annoncÃ©!',
    noParticipants: 'Aucun participant pour tirer un gagnant',

    // Winners History
    winnersHistory: 'Historique des Gagnants',
    noWinners: 'Aucun gagnant pour le moment',
    date: 'Date',
    rank: 'Rang',

    // Messages
    success: 'SuccÃ¨s',
    error: 'Erreur',
    loading: 'Chargement...',
    deleteConfirm: 'ÃŠtes-vous sÃ»r de vouloir supprimer ce giveaway?',
    deleteSuccess: 'Giveaway supprimÃ© avec succÃ¨s',
    deleteError: 'Erreur lors de la suppression',
    updateSuccess: 'Giveaway mis Ã  jour',
    updateError: 'Erreur lors de la mise Ã  jour',

    // Status
    active: 'Actif',
    paused: 'PausÃ©',
    completed: 'TerminÃ©',
    upcoming: 'Ã€ venir',

    // Admin
    adminPanel: 'Panneau Admin',
    adminPassword: 'Mot de passe admin',
    login: 'Connexion',
    logout: 'DÃ©connexion',
    loginError: 'Mot de passe incorrect',
    admin: 'Admin',
    createGiveaway: 'CrÃ©er un Giveaway',
    giveawayPhotos: 'Photos du Giveaway',
    noPhotosAvailable: 'Aucune photo disponible',
    participateButton: 'Participer Maintenant',
    connected: 'ConnectÃ©',
    selectGiveawayFirst: 'SÃ©lectionnez d\'abord un giveaway',
    noParticipants: 'Aucun participant',
    spinWheel: 'Lancer la Roulette',
    winner: 'GAGNANT!',
    newWheel: 'Nouvelle Roulette',
    statistics: 'Statistiques',
    timeRemaining: 'Temps Restant',
    endDate: 'Fin',
    photoCount: 'Photos',
    participantsCount: 'Participants',
    winners: 'Gagnants',
    winnersHistory: 'Historique des Gagnants',
    noWinnersYet: 'Aucun gagnant pour le moment',
    manageAdmin: 'Gestion Admin',
    createNewGiveaway: 'CrÃ©er Giveaway',
    selectGiveawayAdm: 'SÃ©lectionner',
    giveawayDetails: 'DÃ©tails du Giveaway',
    accessDenied: 'AccÃ¨s RefusÃ©',
    youNeedServer: 'Vous avez besoin d\'accÃ¨s au serveur Discord pour participer',
    selectGiveawayModal: 'SÃ©lectionner un Giveaway',
    noGiveawaysAvailable: 'Aucun giveaway disponible',
    createNewModal: 'CrÃ©er un Giveaway',
    selectPhotos: 'SÃ©lectionner les photos',
    optional: '(optionnel)',
    dragPhotosHere: 'Vous pouvez sÃ©lectionner plusieurs images',
    create: 'CrÃ©er',
    adminLogin: 'Connexion Admin',
    password: 'Mot de passe',
    connect: 'Se Connecter',
    uploadInProgress: 'Upload en cours...',
    previous: 'â† PrÃ©cÃ©dent',
    next: 'Suivant â†’',

    // Shop
    shop: 'Boutique',
    availableItems: 'Articles Disponibles',
    shoppingCart: 'Panier',
    emptyCart: 'Votre panier est vide',
    continueShopping: 'â† Continuer',
    buy: 'ðŸ’³ Acheter',
    select: 'âž• SÃ©lectionner',
    outOfStock: 'âŒ Rupture',
    unlimited: 'Stock IllimitÃ©',
    inStock: 'âœ“ En Stock',
    remaining: 'Restant',
    clear: 'ðŸ—‘ï¸ Vider',
    total: 'Total',
    orderConfirmed: 'ðŸŽ‰ Commande confirmÃ©e!',
    mustLoginDiscord: 'âŒ Vous devez vous connecter via Discord pour acheter',
    emptyCartError: 'Votre panier est vide',
    adminManagement: 'Gestion de la Boutique',
    addItem: 'âž• Ajouter Article',
    editItem: 'âœï¸ Ã‰diter',
    deleteItem: 'ðŸ—‘ï¸ Supprimer',
    addArticle: 'Ajouter un Article',
    editArticle: 'Modifier l\'Article',
    itemName: 'Nom du produit',
    itemDescription: 'Description (optionnel)',
    itemPrice: 'Prix',
    itemCategory: 'CatÃ©gorie (ex: Divers)',
    selectImage: 'SÃ©lectionner une image',
    itemQuantity: 'QuantitÃ© (laisser vide = illimitÃ©)',
    accountId: 'ID Compte (ex: ACC001)',
    accountDetails: 'DÃ©tails du compte (optionnel)',
    cancel: 'Annuler',
    save: 'Sauvegarder',
    confirmDelete: 'Confirmer la suppression',
    deleteMessage: 'ÃŠtes-vous sÃ»r de vouloir supprimer cet article?',
    confirm: 'Confirmer',
    noItems: 'Aucun article disponible pour le moment',
    noItemsManagement: 'Aucun article ajoutÃ©',
    name: 'Nom',
    description: 'Description',
    price: 'Prix',
    category: 'CatÃ©gorie',
    stock: 'Stock',
    actions: 'Actions',
    management: 'Gestion des Articles',
    itemNamePlaceholder: 'Nom du produit',
    itemDescriptionPlaceholder: 'Description (optionnel)',
    itemPricePlaceholder: 'Prix',
    itemQuantityPlaceholder: 'QuantitÃ© (laisser vide = illimitÃ©)',
    accountIdPlaceholder: 'ID Compte (ex: ACC001)',
    accountDetailsPlaceholder: 'DÃ©tails du compte (optionnel)',
    categoryPlaceholder: 'CatÃ©gorie (ex: Divers)',
    imageFormat: 'Format: JPG, PNG (max 5MB)',
    deleteConfirmMessage: 'ÃŠtes-vous sÃ»r de vouloir supprimer cet article?',
    delete: 'Supprimer',
    currency: 'Devise',
    EUR: 'EUR â‚¬',
    USD: 'USD $',
    FCFA: 'FCFA',
  },
  en: {
    // Header & Navigation
    title: 'Dragon Ball Giveaway',
    selectGiveaway: 'Select a Giveaway',
    giveawayInfo: 'Giveaway Info',
    uploadPhotos: 'Upload Photos',
    language: 'Language',
    french: 'FranÃ§ais',
    english: 'English',

    // Giveaway Selection
    noGiveaways: 'No active giveaways',
    createNew: 'Create a new giveaway',
    giveawayName: 'Giveaway name',
    giveawayDescription: 'Description',
    duration: 'Duration',
    days: 'days',
    hours: 'hours',
    startGiveaway: 'Start giveaway',
    resetGiveaway: 'New Wheel',
    participants: 'Participants',
    winners: 'Winners',
    endDate: 'Expected end',

    // Photos
    uploadPhotosTitle: 'Add Photos',
    dragAndDrop: 'Drag photos here or click',
    maxPhotos: 'Max 10 photos',
    deletePhoto: 'Delete',
    noPhotos: 'No photos uploaded',

    // Participation
    participateButton: 'Participate',
    discordLoginRequired: 'Discord login required',
    loginWithDiscord: 'Login with Discord',
    participationSuccess: 'Participation registered!',
    participationError: 'Error during participation',
    alreadyParticipated: 'You have already participated in this giveaway',
    nextAllowed: 'You can participate again in',
    minutes: 'minutes',
    hours: 'hours',

    // Roulette/Wheel
    spinWheel: 'Spin the Wheel',
    selectWinner: 'Select a Winner',
    winner: 'WINNER!',
    winnerAnnounced: 'The winner has been announced!',
    noParticipants: 'No participants to draw a winner',

    // Winners History
    winnersHistory: 'Winners History',
    noWinners: 'No winners yet',
    date: 'Date',
    rank: 'Rank',

    // Messages
    success: 'Success',
    error: 'Error',
    loading: 'Loading...',
    deleteConfirm: 'Are you sure you want to delete this giveaway?',
    deleteSuccess: 'Giveaway deleted successfully',
    deleteError: 'Error deleting giveaway',
    updateSuccess: 'Giveaway updated',
    updateError: 'Error updating giveaway',

    // Status
    active: 'Active',
    paused: 'Paused',
    completed: 'Completed',
    upcoming: 'Upcoming',

    // Admin
    adminPanel: 'Admin Panel',
    adminPassword: 'Admin password',
    login: 'Login',
    logout: 'Logout',
    loginError: 'Incorrect password',
    admin: 'Admin',
    createGiveaway: 'Create Giveaway',
    giveawayPhotos: 'Giveaway Photos',
    noPhotosAvailable: 'No photos available',
    participateButton: 'Participate Now',
    connected: 'Connected',
    selectGiveawayFirst: 'Please select a giveaway first',
    noParticipants: 'No participants',
    spinWheel: 'Spin the Wheel',
    winner: 'WINNER!',
    newWheel: 'New Wheel',
    statistics: 'Statistics',
    timeRemaining: 'Time Remaining',
    endDate: 'End',
    photoCount: 'Photos',
    participantsCount: 'Participants',
    winners: 'Winners',
    winnersHistory: 'Winners History',
    noWinnersYet: 'No winners yet',
    manageAdmin: 'Admin Management',
    createNewGiveaway: 'Create Giveaway',
    selectGiveawayAdm: 'Select',
    giveawayDetails: 'Giveaway Details',
    accessDenied: 'Access Denied',
    youNeedServer: 'You need access to the Discord server to participate',
    selectGiveawayModal: 'Select a Giveaway',
    noGiveawaysAvailable: 'No giveaways available',
    createNewModal: 'Create a Giveaway',
    selectPhotos: 'Select photos',
    optional: '(optional)',
    dragPhotosHere: 'You can select multiple images',
    create: 'Create',
    adminLogin: 'Admin Login',
    password: 'Password',
    connect: 'Login',
    uploadInProgress: 'Upload in progress...',
    previous: 'â† Previous',
    next: 'Next â†’',

    // Shop
    shop: 'Shop',
    availableItems: 'Available Items',
    shoppingCart: 'Shopping Cart',
    emptyCart: 'Your cart is empty',
    continueShopping: 'â† Continue',
    buy: 'ðŸ’³ Buy',
    select: 'âž• Select',
    outOfStock: 'âŒ Out of Stock',
    unlimited: 'Unlimited Stock',
    inStock: 'âœ“ In Stock',
    remaining: 'Remaining',
    clear: 'ðŸ—‘ï¸ Clear',
    total: 'Total',
    orderConfirmed: 'ðŸŽ‰ Order confirmed!',
    mustLoginDiscord: 'âŒ You must login via Discord to purchase',
    emptyCartError: 'Your cart is empty',
    adminManagement: 'Shop Management',
    addItem: 'âž• Add Item',
    editItem: 'âœï¸ Edit',
    deleteItem: 'ðŸ—‘ï¸ Delete',
    addArticle: 'Add an Item',
    editArticle: 'Edit Item',
    itemName: 'Product name',
    itemDescription: 'Description (optional)',
    itemPrice: 'Price',
    itemCategory: 'Category (ex: Miscellaneous)',
    selectImage: 'Select an image',
    itemQuantity: 'Quantity (leave empty = unlimited)',
    accountId: 'Account ID (ex: ACC001)',
    accountDetails: 'Account details (optional)',
    cancel: 'Cancel',
    save: 'Save',
    confirmDelete: 'Confirm deletion',
    deleteMessage: 'Are you sure you want to delete this item?',
    confirm: 'Confirm',
    noItems: 'No items available at the moment',
    noItemsManagement: 'No items added',
    name: 'Name',
    description: 'Description',
    price: 'Price',
    category: 'Category',
    stock: 'Stock',
    actions: 'Actions',
    management: 'Item Management',
    itemNamePlaceholder: 'Product name',
    itemDescriptionPlaceholder: 'Description (optional)',
    itemPricePlaceholder: 'Price',
    itemQuantityPlaceholder: 'Quantity (leave empty = unlimited)',
    accountIdPlaceholder: 'Account ID (ex: ACC001)',
    accountDetailsPlaceholder: 'Account details (optional)',
    categoryPlaceholder: 'Category (ex: Miscellaneous)',
    imageFormat: 'Format: JPG, PNG (max 5MB)',
    deleteConfirmMessage: 'Are you sure you want to delete this item?',
    delete: 'Delete',
    currency: 'Currency',
    EUR: 'EUR â‚¬',
    USD: 'USD $',
    FCFA: 'FCFA',
  },
};

/**
 * Obtenir la traduction pour une clÃ©
 */
function t(key, lang = 'fr') {
  return translations[lang]?.[key] || key;
}

/**
 * Initialiser le systÃ¨me de langue
 */
function initLanguage() {
  // RÃ©cupÃ©rer la langue du localStorage ou utiliser le franÃ§ais par dÃ©faut
  let currentLang = localStorage.getItem('language') || 'fr';
  window.currentLanguage = currentLang;
  
  // Ajouter la langue au body pour les styles CSS
  document.documentElement.lang = currentLang;
  
  return currentLang;
}

/**
 * Changer la langue
 */
function setLanguage(lang) {
  if (!translations[lang]) {
    console.warn(`Language ${lang} not supported`);
    return;
  }
  
  window.currentLanguage = lang;
  localStorage.setItem('language', lang);
  document.documentElement.lang = lang;
  
  console.log(`[i18n] Changement de langue vers: ${lang}`);
  translatePage();
  
  // Ã‰mettre un Ã©vÃ©nement pour que les autres scripts sachent que la langue a changÃ©
  window.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: lang } }));
}

/**
 * Traduire tout le contenu texte de la page
 */
function translatePage() {
  const lang = window.currentLanguage || 'fr';
  
  // Traduire les Ã©lÃ©ments avec data-i18n
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    const translation = t(key, lang);
    
    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
      element.placeholder = translation;
    } else if (element.tagName === 'BUTTON') {
      // Pour les boutons, prÃ©server les icÃ´nes/emojis avant le texte
      const textContent = element.textContent.trim();
      // Chercher si le bouton commence par une icÃ´ne/emoji
      const emojiMatch = textContent.match(/^[\s\p{Emoji_Presentation}]+/u);
      if (emojiMatch) {
        element.textContent = emojiMatch[0] + translation;
      } else {
        element.textContent = translation;
      }
    } else {
      element.textContent = translation;
    }
  });

  // Traduire les placeholders
  document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
    const key = element.getAttribute('data-i18n-placeholder');
    element.placeholder = t(key, lang);
  });

  // Traduire les titles
  document.querySelectorAll('[data-i18n-title]').forEach(element => {
    const key = element.getAttribute('data-i18n-title');
    element.title = t(key, lang);
  });

  // Traduire les values (pour buttons avec textContent)
  document.querySelectorAll('[data-i18n-value]').forEach(element => {
    const key = element.getAttribute('data-i18n-value');
    const translation = t(key, lang);
    // PrÃ©server les icÃ´nes comme pour les buttons
    const textContent = element.textContent.trim();
    const emojiMatch = textContent.match(/^[\s\p{Emoji_Presentation}]+/u);
    if (emojiMatch) {
      element.textContent = emojiMatch[0] + translation;
    } else {
      element.textContent = translation;
    }
  });

  console.log(`[i18n] Page traduite en ${lang}`);
}


// === Gestion globale du sélecteur de langue ===
window.initLanguageSelector = function() {
  const languageSelector = document.getElementById('languageSelector');
  if (!languageSelector) return;
  
  // Récupérer la langue depuis l'URL
  const urlParams = new URLSearchParams(window.location.search);
  const currentLang = urlParams.get('lang') || window.currentLanguage || 'fr';
  languageSelector.value = currentLang;
  
  // Listener pour le changement
  languageSelector.addEventListener('change', (e) => {
    const newLang = e.target.value;
    // Ajouter le param lang à l'URL
    const url = new URL(window.location);
    url.searchParams.set('lang', newLang);
    window.history.pushState({}, '', url);
    
    // Appliquer la traduction
    window.currentLanguage = newLang;
    if (typeof setLanguage === 'function') {
      setLanguage(newLang);
    }
    if (typeof applyTranslation === 'function') {
      applyTranslation(newLang);
    }
  });
};

// Initialiser la langue au chargement
initLanguage();

// Auto-init au chargement
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', window.initLanguageSelector);
} else {
  window.initLanguageSelector();
}

