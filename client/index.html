<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dragon Ball Legends - Giveaway</title>
  <link rel="icon" type="image/jpeg" href="assets/dragon-ball-icon.jpg">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="photos-simplified.css">
  <script src="translations.js"></script>
</head>
<body>
  <!-- Background -->
  <video id="backgroundVideo" class="background-video" autoplay muted loop>
    <source src="assets/background.mp4" type="video/mp4">
  </video>
  <div class="overlay"></div>

  <!-- Page Container -->
  <div class="page-wrapper">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo-section">
          <img src="assets/dragon-ball-icon.jpg" alt="Logo" class="logo-image">
          <div class="logo-text">
            <h1>Dragon Ball Legends</h1>
            <p data-i18n-placeholder="participateButton" style="display: none;"></p>
          </div>
        </div>
        <div class="header-actions">
          <select id="languageSelector" class="language-selector">
            <option value="fr">FranÃ§ais</option>
            <option value="en">English</option>
          </select>
          <a href="/shop.html" class="btn-shop" style="text-decoration: none;">ğŸ›ï¸ Shop</a>
          <button id="adminLoginBtn" class="btn-admin">ğŸ” Admin</button>
        </div>
      </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Left Section -->
      <section class="section-left">
        <!-- Giveaway Selection -->
        <div class="card">
          <div class="card-header">
            <span class="card-icon">ğŸ</span>
            <h2 data-i18n="selectGiveaway">SÃ©lectionner un Giveaway</h2>
          </div>
          <div class="card-body">
            <button id="publicSelectGiveawayBtn" class="btn btn-primary btn-full" data-i18n="selectGiveaway">Voir les Giveaways</button>
            <div id="publicGiveawaysListContainer" class="giveaways-list"></div>
          </div>
        </div>

        <!-- Giveaway Info -->
        <div id="giveawayInfoSection" class="card hidden">
          <div class="card-header">
            <span class="card-icon">ğŸ¯</span>
            <div>
              <h2 id="selectedGiveawayName" data-i18n="giveawayInfo">Giveaway Actif</h2>
              <p id="giveawayDescription" class="card-subtitle">-</p>
            </div>
            <button id="clearGiveawayBtn" class="btn-close">âœ•</button>
          </div>
          <div class="card-body">
            <div class="info-grid">
              <div class="info-item">
                <span class="info-icon">â°</span>
                <div>
                  <p class="info-label" data-i18n="timeRemaining">Temps Restant</p>
                  <p id="giveawayTimeLeft" class="info-value">-</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">ğŸ“…</span>
                <div>
                  <p class="info-label" data-i18n="endDate">Fin</p>
                  <p id="giveawayEndDate" class="info-value">-</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">ğŸ‘¥</span>
                <div>
                  <p class="info-label" data-i18n="participantsCount">Participants</p>
                  <p id="giveawayParticipantCount" class="info-value">0</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">ğŸ“¸</span>
                <div>
                  <p class="info-label" data-i18n="photoCount">Photos</p>
                  <p id="giveawayPhotoCount" class="info-value">0</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Photos -->
        <div id="photosSection" class="card hidden">
          <div class="card-header">
            <span class="card-icon">ğŸ“·</span>
            <h2 data-i18n="giveawayPhotos">Photos du Giveaway</h2>
          </div>
          <div class="card-body">
            <div id="publicGiveawayPhotosList" class="photos-grid"></div>
            <p id="noPublicPhotosMessage" class="empty-state" style="display: none;" data-i18n="noPhotosAvailable">Aucune photo disponible</p>
          </div>
        </div>

        <!-- Participation -->
        <div class="card card-accent">
          <div class="card-header">
            <span class="card-icon">âœ¨</span>
            <h2 data-i18n="participateButton">Participer au Giveaway</h2>
          </div>
          <div class="card-body">
            <div id="selectGiveawayFirstMessage" class="alert alert-warning hidden" data-i18n="selectGiveawayFirst">
              âš ï¸ SÃ©lectionnez d'abord un giveaway
            </div>

            <!-- Discord Auth Section -->
            <div class="discord-section">
              <div id="discordUserInfo" class="discord-profile hidden">
                <img id="discordAvatarImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%235865F2'/%3E%3Ctext x='50' y='50' dominant-baseline='middle' text-anchor='middle' font-size='60' fill='white'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="Avatar" class="discord-avatar" crossorigin="anonymous" loading="lazy">
                <div class="discord-info">
                  <p class="discord-username"></p>
                  <p class="discord-status" data-i18n="connected">âœ… ConnectÃ©</p>
                </div>
              </div>

              <!-- Boutons cÃ´te Ã  cÃ´te -->
              <div style="display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: flex-start;">
                <!-- Participer -->
                <div>
                  <form id="participantForm" class="form" style="margin: 0;">
                    <div id="countdownTimer" class="message-box" style="display:none;"></div>
                    <button type="submit" class="btn btn-primary btn-full btn-lg" data-i18n="participateButton">
                      âœ¨ Participer Maintenant
                    </button>
                    <div id="messageBox" class="message-box"></div>
                  </form>
                </div>

                <!-- Discord Icon Button -->
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <button id="discordLoginBtn" class="btn btn-discord-icon" title="Se connecter avec Discord">
                    <svg width="24" height="24" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M60.1045 4.8978C55.3195 2.8214 50.3139 1.2422 45.1245 0.389141C44.6645 1.2914 44.1345 2.4102 43.7745 3.4395C38.3455 2.5581 32.9852 2.5581 27.6852 3.4395C27.3245 2.4102 26.7645 1.2914 26.1852 0.389141C21.0057 1.2422 15.9995 2.8214 11.3145 4.8978C1.93047 21.4694 -0.119578 37.7378 0.0185777 53.8326C5.79617 57.3181 11.6639 59.6849 17.7139 61.0667C18.8555 59.5292 19.9667 57.9241 20.9457 56.1549C19.2064 55.7047 17.5457 55.0782 15.9869 54.297C16.3669 54.0159 16.7345 53.7284 17.0922 53.4474C29.2357 59.9187 42.8545 59.9187 54.9577 53.4474C55.3242 53.7284 55.6769 54.0159 56.0502 54.297C54.4845 55.0782 52.8062 55.7047 51.0505 56.1549C52.0406 57.9241 53.1345 59.5292 54.3011 61.0667C60.3511 59.6849 66.2339 57.3181 71.9995 53.8326C72.2669 35.8453 67.3192 19.7082 60.1045 4.8978ZM23.7259 44.2979C20.2226 44.2979 17.3384 41.1046 17.3384 37.2584C17.3384 33.4121 20.1504 30.2188 23.7259 30.2188C27.3013 30.2188 30.1852 33.4121 30.1852 37.2584C30.1852 41.1046 27.3013 44.2979 23.7259 44.2979ZM47.3045 44.2979C43.8013 44.2979 40.9171 41.1046 40.9171 37.2584C40.9171 33.4121 43.7286 30.2188 47.3045 30.2188C50.8799 30.2188 53.7638 33.4121 53.7638 37.2584C53.7638 41.1046 50.8799 44.2979 47.3045 44.2979Z" fill="currentColor"/>
                    </svg>
                  </button>
                  <button id="discordLogoutBtn" class="btn btn-danger-icon hidden" title="Se dÃ©connecter de Discord">
                    ğŸšª
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Right Section -->
      <section class="section-right">
        <!-- Participants List -->
        <div class="card" id="participantsSection">
          <div class="card-header">
            <span class="card-icon">ğŸ‘¥</span>
            <h2 data-i18n="participantsCount">Participants</h2>
            <span class="badge" id="participantsCountBadge">0</span>
          </div>
          <div class="card-body scrollable">
            <div id="participantsList" class="participants-list">
              <p class="empty-state" data-i18n="noParticipants">Aucun participant</p>
            </div>
          </div>
        </div>

        <!-- Roulette -->
        <div class="card card-roulette" id="rouletteSection">
          <div class="card-header">
            <span class="card-icon">ğŸ¡</span>
            <h2 data-i18n="spinWheel">Roulette</h2>
          </div>
          <div class="card-body card-center">
            <div class="roulette-container">
              <canvas id="wheelCanvas" width="280" height="280" class="wheel"></canvas>
              <div class="pointer"></div>
            </div>
            <button id="spinButton" class="btn btn-success btn-full btn-lg" data-i18n="spinWheel">Lancer la Roulette</button>
            
            <div id="winnerDisplay" class="winner-box hidden">
              <div class="winner-confetti"></div>
              <h3 data-i18n="winner">ğŸ† GAGNANT! ğŸ†</h3>
              <p id="winnerName" class="winner-name">-</p>
              <button id="resetButton" class="btn btn-secondary" data-i18n="newWheel">Nouvelle Roulette</button>
            </div>
          </div>
        </div>

        <!-- Statistics -->
        <div class="card" id="statsSection">
          <div class="card-header">
            <span class="card-icon">ğŸ“Š</span>
            <h2 data-i18n="statistics">Statistiques</h2>
          </div>
          <div class="card-body">
            <div class="stats-grid">
              <div class="stat-box">
                <p class="stat-label" data-i18n="participantsCount">Participants</p>
                <p id="participantCount" class="stat-value">0</p>
              </div>
              <div class="stat-box">
                <p class="stat-label" data-i18n="winners">Gagnants</p>
                <p id="winnerCount" class="stat-value">0</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Winners History -->
        <div class="card">
          <div class="card-header">
            <span class="card-icon">ğŸ†</span>
            <h2 data-i18n="winnersHistory">Historique des Gagnants</h2>
          </div>
          <div class="card-body scrollable">
            <div id="winnersList" class="winners-list">
              <p class="empty-state" data-i18n="noWinnersYet">Aucun gagnant pour le moment</p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Admin Section (initially hidden) -->
    <div id="adminGiveawaySection" class="admin-section hidden">
      <div class="card">
        <div class="card-header admin-header">
          <span class="card-icon">âš™ï¸</span>
          <h2 data-i18n="manageAdmin">Gestion Admin</h2>
          <span class="admin-badge" data-i18n="admin">Admin</span>
        </div>
        <div class="card-body">
          <div class="admin-buttons">
            <button id="createNewGiveawayBtn" class="btn btn-primary" data-i18n="createGiveaway">â• CrÃ©er Giveaway</button>
            <button id="selectGiveawayBtn" class="btn btn-secondary" data-i18n="selectGiveawayAdm">ğŸ¡ SÃ©lectionner</button>
          </div>
        </div>
      </div>

      <!-- Admin Photos Section -->
      <div id="giveawayPhotosContainer" class="card hidden">
        <div class="card-header">
          <span class="card-icon">ğŸ“·</span>
          <h2 data-i18n="managePhotos">GÃ©rer les Photos</h2>
        </div>
        <div class="card-body">
          <div id="giveawayPhotosList" class="photos-grid"></div>
          <p id="noPhotosMessage" class="empty-state" style="display: block;" data-i18n="noPhotosAvailable">Aucune photo disponible</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Participation Modal -->
  <div id="participationModal" class="modal hidden">
    <div class="modal-content">
      <button class="modal-close">âœ•</button>
      <div id="participationContent"></div>
    </div>
  </div>

  <!-- Admin Login Modal -->
  <div id="adminLoginModal" class="modal hidden">
    <div class="modal-content modal-sm">
      <button id="closeAdminLoginModal" class="modal-close">âœ•</button>
      <h2 data-i18n="adminLogin">Connexion Admin</h2>
      <form id="adminLoginForm">
        <input type="password" id="adminLoginPassword" class="input" data-i18n-placeholder="password" placeholder="Mot de passe" required>
        <button id="adminLoginSubmitBtn" type="button" class="btn btn-primary btn-full" data-i18n="connect">Se Connecter</button>
      </form>
      <div id="adminLoginMessage" class="message-box"></div>
    </div>
  </div>

  <!-- Discord Auth Error Modal -->
  <div id="discordAuthErrorModal" class="modal hidden">
    <div class="modal-content modal-sm discord-error-modal">
      <button id="closeDiscordAuthErrorModal" class="modal-close">âœ•</button>
      
      <div class="discord-error-icon">ğŸ”</div>
      
      <h2 class="discord-error-title" data-i18n="accessDenied">AccÃ¨s RefusÃ©</h2>
      
      <p id="discordAuthErrorMessage" class="discord-error-message"></p>
      
      <div id="discordAuthErrorDetails" class="discord-error-details" style="display: none;"></div>
      
      <div class="discord-error-actions">
        <button id="discordAuthJoinBtn" class="btn btn-discord-primary btn-full"></button>
      </div>
      
      <div class="discord-error-footer">
        <p data-i18n="youNeedServer">Vous avez besoin d'accÃ¨s au serveur Discord pour participer</p>
      </div>
    </div>
  </div>

  <!-- Select Giveaway Modal -->
  <div id="selectGiveawayModal" class="modal hidden">
    <div class="modal-content">
      <button id="closeSelectGiveawayModal" class="modal-close">âœ•</button>
      <h2 data-i18n="selectGiveawayModal">SÃ©lectionner un Giveaway</h2>
      <div id="selectGiveawayListContainer" class="giveaways-list" style="margin-top: 15px;"></div>
      <p id="noGiveawaysMessage" class="empty-state" style="margin-top: 15px; display: none;" data-i18n="noGiveawaysAvailable">Aucun giveaway disponible</p>
    </div>
  </div>

  <!-- Create Giveaway Modal -->
  <div id="createGiveawayModal" class="modal hidden">
    <div class="modal-content">
      <button id="closeCreateGiveawayModal" class="modal-close">âœ•</button>
      <h2 data-i18n="createNewModal">CrÃ©er un Giveaway</h2>
      <form id="createGiveawayForm" class="form" style="margin-top: 15px;">
        <input type="text" id="giveawayName" class="input" data-i18n-placeholder="giveawayName" placeholder="Nom du giveaway" required>
        <textarea id="giveawayDesc" class="input" data-i18n-placeholder="giveawayDescription" placeholder="Description" rows="3"></textarea>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
          <input type="number" id="giveawayDays" class="input" data-i18n-placeholder="days" placeholder="Jours" value="0" min="0">
          <input type="number" id="giveawayHours" class="input" data-i18n-placeholder="hours" placeholder="Heures" value="0" min="0" max="23">
        </div>
        <div style="margin-top: 15px;">
          <label style="color: var(--light); font-size: 0.9rem; margin-bottom: 8px; display: block;" data-i18n="selectPhotos">SÃ©lectionner les photos (optionnel)</label>
          <input type="file" id="giveawayPhotosInput" class="input" multiple accept="image/*" style="padding: 10px; cursor: pointer;">
          <small style="color: var(--gray); display: block; margin-top: 5px;" data-i18n="dragPhotosHere">Vous pouvez sÃ©lectionner plusieurs images</small>
        </div>
        <button type="button" id="createGiveawaySubmitBtn" class="btn btn-primary btn-full" style="margin-top: 15px;" data-i18n="create">CrÃ©er</button>
      </form>
      <div id="createGiveawayMessage" class="message-box" style="margin-top: 15px;"></div>
    </div>
  </div>

  <!-- Admin Panel Modal -->
  <div id="adminModal" class="modal hidden">
    <div class="modal-content modal-sm">
      <button id="closeAdminModalBtn" class="modal-close">âœ•</button>
      <h2 data-i18n="adminPanel">Panel Admin</h2>
      <div style="margin-top: 15px;">
        <p id="adminMessage" class="message-box"></p>
        <input type="password" id="adminPassword" class="input" data-i18n-placeholder="password" placeholder="Mot de passe" style="margin-top: 15px;">
        <button id="adminSubmitBtn" type="button" class="btn btn-primary btn-full" style="margin-top: 15px;" data-i18n="login">Valider</button>
      </div>
    </div>
  </div>

  <!-- Fullscreen Photo Viewer -->
  <div id="fullscreenViewer" class="modal hidden">
    <div class="modal-content" style="max-width: 90vw; max-height: 90vh;">
      <button id="closeViewer" class="modal-close">âœ•</button>
      <img id="viewerImage" src="" alt="Photo" style="width: 100%; max-height: 80vh; object-fit: contain;">
      <div style="display: flex; gap: 10px; margin-top: 15px; justify-content: space-between; align-items: center;">
        <button id="prevViewer" class="btn btn-secondary" data-i18n-value="previous">â† PrÃ©cÃ©dent</button>
        <span id="viewerCounter" style="color: var(--gray);">1 / 1</span>
        <button id="nextViewer" class="btn btn-secondary" data-i18n-value="next">Suivant â†’</button>
      </div>
    </div>
  </div>

  <!-- Photo Upload Modal -->
  <div id="uploadModal" class="modal hidden">
    <div class="modal-content modal-sm">
      <h3 data-i18n="uploadInProgress">Upload en cours...</h3>
      <div id="progressFill" style="height: 20px; background: linear-gradient(90deg, #5865F2 0%, #FF9F00 100%); border-radius: 10px; margin-top: 10px;"></div>
      <p id="uploadStatus" style="text-align: center; margin-top: 10px; color: var(--gray);">0%</p>
    </div>
  </div>

  <!-- Giveaway Details Modal -->
  <div id="giveawayDetailsModal" class="modal hidden">
    <div class="modal-content">
      <button id="closeGiveawayDetailsModal" class="modal-close">âœ•</button>
      <h2 data-i18n="giveawayDetails">DÃ©tails du Giveaway</h2>
      <div id="giveawayDetailsContent" style="margin-top: 15px;"></div>
    </div>
  </div>

  <!-- Hidden Elements -->
  <input type="file" id="giveawayPhotos" style="display: none;" multiple accept="image/*">
  <input type="file" id="giveawayPhotosInput" style="display: none;" multiple accept="image/*">
  <button id="uploadPhotosBtn" style="display: none;"></button>
  <button id="clearPhotosBtn" style="display: none;"></button>
  <div id="publicGiveawayPhotosContainer" style="display: none;"></div>

  <!-- Loading Spinner -->
  <div id="loadingSpinner" class="spinner hidden"></div>

  <script src="app.js"></script>
</body>
</html>
